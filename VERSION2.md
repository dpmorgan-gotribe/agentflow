# AgenticFlow v2 - Implementation Spec

> Minimal agentic design system: 2 agents, 5 commands, TypeScript.

---

## What We're Building

```
agentflow init my-app     → Creates project with agents, skills, commands
agentflow analyze         → Analyst extracts styles, flows, assets, components
agentflow flows           → UI Designer creates flow mockups
agentflow mockups         → UI Designer creates style mockups (3 options)
agentflow stylesheet      → UI Designer creates design system
agentflow screens         → UI Designer creates all screen HTMLs
```

---

## Project Structure (Generated by `init`)

```
my-app/
├── agents/
│   ├── analyst/
│   │   ├── agent.json
│   │   └── system.md
│   └── ui-designer/
│       ├── agent.json
│       └── system.md
│
├── skills/
│   ├── analysis/
│   │   ├── analyze-styles.md
│   │   ├── analyze-flows.md
│   │   ├── analyze-assets.md
│   │   └── analyze-components.md
│   └── design/
│       ├── design-flow.md
│       ├── design-mockup.md
│       ├── design-stylesheet.md
│       └── design-screen.md
│
├── commands/
│   ├── analyze.md
│   ├── flows.md
│   ├── mockups.md
│   ├── stylesheet.md
│   └── screens.md
│
├── assets/
│   ├── wireframes/        # User adds PNGs here
│   ├── fonts/
│   └── icons/
│
├── outputs/               # Generated by commands
│   ├── analysis/
│   ├── flows/
│   ├── mockups/
│   ├── stylesheet/
│   └── screens/
│
└── CLAUDE.md              # Project context for Claude
```

---

## CLI Tool Structure

```
agentflow/
├── src/
│   ├── index.ts           # CLI entry point
│   ├── commands/
│   │   ├── init.ts        # Create new project
│   │   ├── analyze.ts     # Run analyst
│   │   ├── flows.ts       # Run flow mockups
│   │   ├── mockups.ts     # Run style mockups
│   │   ├── stylesheet.ts  # Run stylesheet
│   │   └── screens.ts     # Run all screens
│   ├── lib/
│   │   ├── project.ts     # Project loading/validation
│   │   ├── agent.ts       # Agent invocation via Claude CLI
│   │   └── worker.ts      # Parallel worker spawning
│   └── templates/         # Files copied during init
│       ├── agents/
│       ├── skills/
│       ├── commands/
│       └── CLAUDE.md
├── package.json
└── tsconfig.json
```

---

## Implementation Tasks

### 1. CLI Setup

**File: `src/index.ts`**

```typescript
#!/usr/bin/env node
import { Command } from 'commander';
import { init } from './commands/init';
import { analyze } from './commands/analyze';
import { flows } from './commands/flows';
import { mockups } from './commands/mockups';
import { stylesheet } from './commands/stylesheet';
import { screens } from './commands/screens';

const program = new Command();

program
  .name('agentflow')
  .description('Agentic design pipeline')
  .version('2.0.0');

program
  .command('init <name>')
  .description('Create a new project')
  .action(init);

program
  .command('analyze')
  .description('Analyze wireframes and assets')
  .action(analyze);

program
  .command('flows')
  .description('Create flow mockups')
  .action(flows);

program
  .command('mockups')
  .description('Create style mockups')
  .action(mockups);

program
  .command('stylesheet')
  .option('--style <number>', 'Style to use (1, 2, or 3)', '1')
  .description('Create design system')
  .action(stylesheet);

program
  .command('screens')
  .description('Create all screen designs')
  .action(screens);

program.parse();
```

**File: `package.json`**

```json
{
  "name": "agentflow",
  "version": "2.0.0",
  "type": "module",
  "bin": {
    "agentflow": "./dist/index.js"
  },
  "scripts": {
    "build": "tsc",
    "dev": "tsc --watch"
  },
  "dependencies": {
    "commander": "^12.0.0"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "typescript": "^5.0.0"
  }
}
```

---

### 2. Init Command

**File: `src/commands/init.ts`**

```typescript
import { mkdir, cp, writeFile } from 'fs/promises';
import { join, dirname } from 'path';
import { fileURLToPath } from 'url';

const __dirname = dirname(fileURLToPath(import.meta.url));
const TEMPLATES = join(__dirname, '..', 'templates');

export async function init(name: string) {
  const projectDir = join(process.cwd(), name);

  console.log(`Creating project: ${name}`);

  // Create directory structure
  const dirs = [
    'agents/analyst',
    'agents/ui-designer',
    'skills/analysis',
    'skills/design',
    'commands',
    'assets/wireframes',
    'assets/fonts',
    'assets/icons',
    'outputs/analysis',
    'outputs/flows',
    'outputs/mockups',
    'outputs/stylesheet',
    'outputs/screens'
  ];

  for (const dir of dirs) {
    await mkdir(join(projectDir, dir), { recursive: true });
  }

  // Copy templates
  await cp(join(TEMPLATES, 'agents'), join(projectDir, 'agents'), { recursive: true });
  await cp(join(TEMPLATES, 'skills'), join(projectDir, 'skills'), { recursive: true });
  await cp(join(TEMPLATES, 'commands'), join(projectDir, 'commands'), { recursive: true });
  await cp(join(TEMPLATES, 'CLAUDE.md'), join(projectDir, 'CLAUDE.md'));

  // Create .gitkeep files
  const gitkeeps = ['assets/wireframes', 'assets/fonts', 'assets/icons'];
  for (const dir of gitkeeps) {
    await writeFile(join(projectDir, dir, '.gitkeep'), '');
  }

  console.log(`
Project created: ${name}

Next steps:
  cd ${name}
  # Add wireframes to assets/wireframes/
  agentflow analyze
`);
}
```

---

### 3. Agent Invocation

**File: `src/lib/agent.ts`**

```typescript
import { spawn } from 'child_process';
import { readFile } from 'fs/promises';
import { join } from 'path';

interface AgentConfig {
  id: string;
  name: string;
  skills: string[];
}

export async function loadAgent(projectDir: string, agentId: string): Promise<AgentConfig> {
  const configPath = join(projectDir, 'agents', agentId, 'agent.json');
  const content = await readFile(configPath, 'utf-8');
  return JSON.parse(content);
}

export async function loadSystemPrompt(projectDir: string, agentId: string): Promise<string> {
  const promptPath = join(projectDir, 'agents', agentId, 'system.md');
  return readFile(promptPath, 'utf-8');
}

export async function loadSkill(projectDir: string, skillPath: string): Promise<string> {
  const fullPath = join(projectDir, 'skills', `${skillPath}.md`);
  return readFile(fullPath, 'utf-8');
}

export async function invokeAgent(
  systemPrompt: string,
  userPrompt: string
): Promise<string> {
  return new Promise((resolve, reject) => {
    const claude = spawn('claude', [
      '--print',
      '--system-prompt', systemPrompt,
      '--message', userPrompt
    ]);

    let output = '';
    let error = '';

    claude.stdout.on('data', (data) => { output += data; });
    claude.stderr.on('data', (data) => { error += data; });

    claude.on('close', (code) => {
      if (code === 0) {
        resolve(output);
      } else {
        reject(new Error(`Claude exited with code ${code}: ${error}`));
      }
    });
  });
}
```

---

### 4. Parallel Worker Spawning

**File: `src/lib/worker.ts`**

```typescript
import { invokeAgent } from './agent';

interface WorkerTask {
  id: string;
  systemPrompt: string;
  userPrompt: string;
}

interface WorkerResult {
  id: string;
  output: string;
  error?: string;
}

export async function runWorkersParallel(tasks: WorkerTask[]): Promise<WorkerResult[]> {
  console.log(`Spawning ${tasks.length} workers in parallel...`);

  const promises = tasks.map(async (task) => {
    console.log(`  Starting: ${task.id}`);
    try {
      const output = await invokeAgent(task.systemPrompt, task.userPrompt);
      console.log(`  Completed: ${task.id}`);
      return { id: task.id, output };
    } catch (err) {
      const error = err instanceof Error ? err.message : String(err);
      console.log(`  Failed: ${task.id} - ${error}`);
      return { id: task.id, output: '', error };
    }
  });

  return Promise.all(promises);
}

export async function runWorkerSequential(task: WorkerTask): Promise<WorkerResult> {
  console.log(`Running: ${task.id}`);
  try {
    const output = await invokeAgent(task.systemPrompt, task.userPrompt);
    console.log(`Completed: ${task.id}`);
    return { id: task.id, output };
  } catch (err) {
    const error = err instanceof Error ? err.message : String(err);
    console.log(`Failed: ${task.id} - ${error}`);
    return { id: task.id, output: '', error };
  }
}
```

---

### 5. Analyze Command

**File: `src/commands/analyze.ts`**

```typescript
import { readdir, writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { loadAgent, loadSystemPrompt, loadSkill } from '../lib/agent';
import { runWorkersParallel } from '../lib/worker';

export async function analyze() {
  const projectDir = process.cwd();

  // Verify wireframes exist
  const wireframesDir = join(projectDir, 'assets', 'wireframes');
  const wireframes = await readdir(wireframesDir);
  const images = wireframes.filter(f => /\.(png|jpg|jpeg|gif)$/i.test(f));

  if (images.length === 0) {
    console.error('No wireframes found in assets/wireframes/');
    console.error('Add PNG or JPG files and try again.');
    process.exit(1);
  }

  console.log(`Found ${images.length} wireframe(s)`);

  // Load agent
  const agent = await loadAgent(projectDir, 'analyst');
  const systemPrompt = await loadSystemPrompt(projectDir, 'analyst');

  // Load skills
  const skills = await Promise.all(
    agent.skills.map(s => loadSkill(projectDir, s))
  );

  // Create worker tasks
  const tasks = [
    { id: 'styles', skill: 'analysis/analyze-styles' },
    { id: 'flows', skill: 'analysis/analyze-flows' },
    { id: 'assets', skill: 'analysis/analyze-assets' },
    { id: 'components', skill: 'analysis/analyze-components' }
  ];

  const workerTasks = await Promise.all(tasks.map(async (task) => {
    const skill = await loadSkill(projectDir, task.skill);
    return {
      id: task.id,
      systemPrompt: `${systemPrompt}\n\n## Skill\n\n${skill}`,
      userPrompt: `Analyze the wireframes in assets/wireframes/ and produce output according to the skill.`
    };
  }));

  // Run workers in parallel
  const results = await runWorkersParallel(workerTasks);

  // Write outputs
  const outputDir = join(projectDir, 'outputs', 'analysis');
  await mkdir(outputDir, { recursive: true });

  for (const result of results) {
    if (result.output) {
      await writeFile(
        join(outputDir, `${result.id}.md`),
        result.output
      );
    }
  }

  console.log(`
Analysis complete!

Outputs written to outputs/analysis/
  - styles.md
  - flows.md
  - assets.md
  - components.md

Next: Review the outputs, then run:
  agentflow flows
`);
}
```

---

### 6. Flows Command

**File: `src/commands/flows.ts`**

```typescript
import { readFile, writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { loadSystemPrompt, loadSkill } from '../lib/agent';
import { runWorkersParallel } from '../lib/worker';

export async function flows() {
  const projectDir = process.cwd();

  // Load flows from analysis
  const flowsPath = join(projectDir, 'outputs', 'analysis', 'flows.md');
  const flowsContent = await readFile(flowsPath, 'utf-8');

  // Parse flows (extract flow names from markdown headers)
  const flowMatches = flowsContent.match(/^## Flow \d+: (.+)$/gm) || [];
  const flowNames = flowMatches.map(m => m.replace(/^## Flow \d+: /, ''));

  if (flowNames.length === 0) {
    console.error('No flows found in outputs/analysis/flows.md');
    process.exit(1);
  }

  console.log(`Found ${flowNames.length} flow(s): ${flowNames.join(', ')}`);

  // Load skill and system prompt
  const systemPrompt = await loadSystemPrompt(projectDir, 'ui-designer');
  const skill = await loadSkill(projectDir, 'design/design-flow');
  const stylesContent = await readFile(
    join(projectDir, 'outputs', 'analysis', 'styles.md'),
    'utf-8'
  );

  // Create worker tasks (one per flow)
  const workerTasks = flowNames.map((flowName, index) => ({
    id: `flow-${index + 1}`,
    systemPrompt: `${systemPrompt}\n\n## Skill\n\n${skill}`,
    userPrompt: `Create a flow mockup for: ${flowName}\n\nUse Style 1 (wireframe faithful).\n\nStyles:\n${stylesContent}\n\nFlows:\n${flowsContent}`
  }));

  // Run workers in parallel
  const results = await runWorkersParallel(workerTasks);

  // Write outputs
  const outputDir = join(projectDir, 'outputs', 'flows');
  await mkdir(outputDir, { recursive: true });

  for (let i = 0; i < results.length; i++) {
    const result = results[i];
    if (result.output) {
      const filename = `${result.id}-${flowNames[i].toLowerCase().replace(/\s+/g, '-')}.html`;
      await writeFile(join(outputDir, filename), result.output);
    }
  }

  console.log(`
Flow mockups complete!

Outputs written to outputs/flows/

Next: Review the flow mockups, then run:
  agentflow mockups
`);
}
```

---

### 7. Mockups Command

**File: `src/commands/mockups.ts`**

```typescript
import { readFile, writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { loadSystemPrompt, loadSkill } from '../lib/agent';
import { runWorkersParallel } from '../lib/worker';

export async function mockups() {
  const projectDir = process.cwd();

  // Load analysis outputs
  const stylesContent = await readFile(
    join(projectDir, 'outputs', 'analysis', 'styles.md'),
    'utf-8'
  );
  const componentsContent = await readFile(
    join(projectDir, 'outputs', 'analysis', 'components.md'),
    'utf-8'
  );

  // Load skill and system prompt
  const systemPrompt = await loadSystemPrompt(projectDir, 'ui-designer');
  const skill = await loadSkill(projectDir, 'design/design-mockup');

  // Create worker tasks (one per style: 1, 2, 3)
  const styles = [
    { id: 'style-1', name: 'Wireframe Faithful', description: 'Matches wireframes exactly' },
    { id: 'style-2', name: 'Modern', description: 'Creative modern interpretation' },
    { id: 'style-3', name: 'Bold', description: 'Creative bold interpretation' }
  ];

  const workerTasks = styles.map((style) => ({
    id: style.id,
    systemPrompt: `${systemPrompt}\n\n## Skill\n\n${skill}`,
    userPrompt: `Create a style mockup for: ${style.name} (${style.description})\n\nStyles:\n${stylesContent}\n\nComponents:\n${componentsContent}`
  }));

  // Run workers in parallel
  const results = await runWorkersParallel(workerTasks);

  // Write outputs
  const outputDir = join(projectDir, 'outputs', 'mockups');
  await mkdir(outputDir, { recursive: true });

  for (const result of results) {
    if (result.output) {
      await writeFile(
        join(outputDir, `${result.id}.html`),
        result.output
      );
    }
  }

  console.log(`
Style mockups complete!

Outputs written to outputs/mockups/
  - style-1.html (Wireframe Faithful)
  - style-2.html (Modern)
  - style-3.html (Bold)

Next: Review and pick a style, then run:
  agentflow stylesheet --style=1
`);
}
```

---

### 8. Stylesheet Command

**File: `src/commands/stylesheet.ts`**

```typescript
import { readFile, writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { loadSystemPrompt, loadSkill } from '../lib/agent';
import { runWorkerSequential } from '../lib/worker';

interface StylesheetOptions {
  style: string;
}

export async function stylesheet(options: StylesheetOptions) {
  const projectDir = process.cwd();
  const styleNum = options.style || '1';

  console.log(`Creating stylesheet for style ${styleNum}`);

  // Load analysis outputs
  const stylesContent = await readFile(
    join(projectDir, 'outputs', 'analysis', 'styles.md'),
    'utf-8'
  );
  const componentsContent = await readFile(
    join(projectDir, 'outputs', 'analysis', 'components.md'),
    'utf-8'
  );

  // Load selected mockup
  const mockupContent = await readFile(
    join(projectDir, 'outputs', 'mockups', `style-${styleNum}.html`),
    'utf-8'
  );

  // Load skill and system prompt
  const systemPrompt = await loadSystemPrompt(projectDir, 'ui-designer');
  const skill = await loadSkill(projectDir, 'design/design-stylesheet');

  // Single worker (no parallelization)
  const result = await runWorkerSequential({
    id: 'stylesheet',
    systemPrompt: `${systemPrompt}\n\n## Skill\n\n${skill}`,
    userPrompt: `Create a complete design system based on style ${styleNum}.\n\nStyles:\n${stylesContent}\n\nComponents:\n${componentsContent}\n\nSelected Mockup:\n${mockupContent}`
  });

  // Write outputs
  const outputDir = join(projectDir, 'outputs', 'stylesheet');
  await mkdir(outputDir, { recursive: true });

  if (result.output) {
    // Parse output - expect HTML and CSS sections
    await writeFile(join(outputDir, 'showcase.html'), result.output);
  }

  console.log(`
Stylesheet complete!

Outputs written to outputs/stylesheet/

Next: Review the design system, then run:
  agentflow screens
`);
}
```

---

### 9. Screens Command

**File: `src/commands/screens.ts`**

```typescript
import { readFile, readdir, writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { loadSystemPrompt, loadSkill } from '../lib/agent';
import { runWorkersParallel } from '../lib/worker';

export async function screens() {
  const projectDir = process.cwd();

  // Load flow mockups to extract screen list
  const flowsDir = join(projectDir, 'outputs', 'flows');
  const flowFiles = await readdir(flowsDir);

  // Read all flows and extract screens
  const screens: { name: string; flow: string }[] = [];
  for (const file of flowFiles) {
    if (file.endsWith('.html')) {
      const content = await readFile(join(flowsDir, file), 'utf-8');
      // Extract screen names from flow mockup (look for screen divs/sections)
      const screenMatches = content.match(/id="screen-(\w+)"/g) || [];
      for (const match of screenMatches) {
        const name = match.replace(/id="screen-/, '').replace(/"/, '');
        screens.push({ name, flow: file });
      }
    }
  }

  // Deduplicate screens
  const uniqueScreens = [...new Set(screens.map(s => s.name))];

  if (uniqueScreens.length === 0) {
    console.error('No screens found in flow mockups');
    process.exit(1);
  }

  console.log(`Found ${uniqueScreens.length} unique screen(s)`);

  // Load stylesheet
  const stylesheetContent = await readFile(
    join(projectDir, 'outputs', 'stylesheet', 'showcase.html'),
    'utf-8'
  );

  // Load skill and system prompt
  const systemPrompt = await loadSystemPrompt(projectDir, 'ui-designer');
  const skill = await loadSkill(projectDir, 'design/design-screen');

  // Create worker tasks (one per screen)
  const workerTasks = uniqueScreens.map((screenName, index) => ({
    id: `screen-${String(index + 1).padStart(2, '0')}`,
    systemPrompt: `${systemPrompt}\n\n## Skill\n\n${skill}`,
    userPrompt: `Create the full design for screen: ${screenName}\n\nUse the stylesheet:\n${stylesheetContent}`
  }));

  // Run workers in parallel
  const results = await runWorkersParallel(workerTasks);

  // Write outputs
  const outputDir = join(projectDir, 'outputs', 'screens');
  await mkdir(outputDir, { recursive: true });

  for (let i = 0; i < results.length; i++) {
    const result = results[i];
    if (result.output) {
      const filename = `${result.id}-${uniqueScreens[i]}.html`;
      await writeFile(join(outputDir, filename), result.output);
    }
  }

  console.log(`
All screens complete!

Outputs written to outputs/screens/

Design pipeline finished!
`);
}
```

---

## Template Files

### Analyst Agent

**File: `templates/agents/analyst/agent.json`**

```json
{
  "id": "analyst",
  "name": "Analyst",
  "description": "Analyzes wireframes and extracts design requirements",
  "skills": [
    "analysis/analyze-styles",
    "analysis/analyze-flows",
    "analysis/analyze-assets",
    "analysis/analyze-components"
  ]
}
```

**File: `templates/agents/analyst/system.md`**

```markdown
# Analyst Agent

You are a Senior UX/UI Analyst. Your job is to analyze wireframes and extract precise design specifications.

## Core Principles

1. **Precision** - Extract exact hex values, pixel dimensions, not approximations
2. **Structure** - Identify layout patterns before visual details
3. **Completeness** - Document everything downstream agents need
4. **Constraints** - What CAN'T change is as important as what can

## Output Format

Always output well-structured markdown with clear sections and tables.
```

---

### UI Designer Agent

**File: `templates/agents/ui-designer/agent.json`**

```json
{
  "id": "ui-designer",
  "name": "UI Designer",
  "description": "Creates mockups, stylesheets, and screen designs",
  "skills": [
    "design/design-flow",
    "design/design-mockup",
    "design/design-stylesheet",
    "design/design-screen"
  ]
}
```

**File: `templates/agents/ui-designer/system.md`**

```markdown
# UI Designer Agent

You are a Senior UI Designer. Your job is to create HTML mockups and design systems.

## Core Principles

1. **Wireframe Fidelity** - Style 1 always matches wireframes exactly
2. **Self-Contained HTML** - All CSS inline in <style> tag, no external dependencies
3. **Solid Backgrounds** - Header/footer must have solid backgrounds, never transparent
4. **Fixed Chrome** - Use position:fixed for app header/footer

## Output Format

Always output complete, valid HTML files that can be opened directly in a browser.
```

---

### Skills

**File: `templates/skills/analysis/analyze-styles.md`**

```markdown
# Analyze Styles

Extract visual style information from wireframes.

## Process

1. **Colors** - Extract all hex values, categorize (primary, secondary, accent, neutral)
2. **Typography** - Identify fonts, sizes in pixels, weights
3. **Spacing** - Measure consistent spacing values (4px, 8px, 16px scale)
4. **Components** - Button styles, input styles, card styles

## Output Format

```markdown
# Style Analysis

## Style 1: Wireframe Faithful
(Exact colors and values from wireframe)

## Style 2: [Creative Name]
(Alternative palette with same structure)

## Style 3: [Creative Name]
(Different creative direction)
```
```

**File: `templates/skills/analysis/analyze-flows.md`**

```markdown
# Analyze Flows

Map user journeys from wireframes.

## Process

1. Identify primary user flow (80% of usage)
2. Identify onboarding flow
3. Identify secondary flows
4. List screens in each flow with transitions

## Output Format

```markdown
# Flow Analysis

## Flow 1: [Name]
Screens: A → B → C
Purpose: [What user accomplishes]

## Flow 2: [Name]
...
```
```

**File: `templates/skills/analysis/analyze-assets.md`**

```markdown
# Analyze Assets

Inventory all assets in the project.

## Process

1. List wireframe images
2. Identify fonts needed
3. Identify icons needed
4. Note any brand assets

## Output Format

```markdown
# Asset Inventory

## Wireframes
- [filename]: [description]

## Fonts Needed
- [font name]: [where used]

## Icons Needed
- [icon name]: [where used]
```
```

**File: `templates/skills/analysis/analyze-components.md`**

```markdown
# Analyze Components

Identify UI components from wireframes.

## Process

1. List all unique components
2. Note variants (sizes, states)
3. Document hierarchy (atoms, molecules, organisms)

## Output Format

```markdown
# Component Inventory

## Buttons
- Primary: [description]
- Secondary: [description]

## Inputs
- Text: [description]
- Select: [description]

## Cards
...
```
```

**File: `templates/skills/design/design-flow.md`**

```markdown
# Design Flow Mockup

Create a visual representation of a user flow.

## Output

Single HTML file showing:
- 3-7 key screens in the flow (simplified)
- Arrows between screens
- User actions annotated
- Data requirements noted

## Template

```html
<!DOCTYPE html>
<html>
<head>
  <title>Flow: [Name]</title>
  <style>
    /* Flow layout styles */
  </style>
</head>
<body>
  <h1>Flow: [Name]</h1>
  <div class="flow">
    <div class="screen" id="screen-[name]">
      <!-- Simplified screen -->
    </div>
    <div class="arrow">→</div>
    <!-- More screens -->
  </div>
</body>
</html>
```
```

**File: `templates/skills/design/design-mockup.md`**

```markdown
# Design Style Mockup

Create a single-page preview of a style.

## Output

Single HTML file showing:
- Representative page with full styling
- Key components visible
- The "feel" of this style direction

## Key Rules

- Style 1: MUST match wireframe exactly
- Styles 2-3: Creative alternatives
- All CSS in <style> tag
- No external dependencies
```

**File: `templates/skills/design/design-stylesheet.md`**

```markdown
# Design Stylesheet

Create a complete design system.

## Output

HTML file containing:
- CSS variables (colors, fonts, spacing)
- All component styles
- Component showcase/examples
- Interactive states (hover, active, disabled)

## Structure

```html
<!DOCTYPE html>
<html>
<head>
  <style>
    :root {
      /* Color tokens */
      /* Typography tokens */
      /* Spacing tokens */
    }
    /* Component styles */
  </style>
</head>
<body>
  <h1>Design System</h1>
  <!-- Component showcase -->
</body>
</html>
```
```

**File: `templates/skills/design/design-screen.md`**

```markdown
# Design Screen

Create a full screen design.

## Output

Single HTML file for one screen:
- Complete layout
- All components styled per stylesheet
- Realistic content
- All states if applicable (loading, error, empty)

## Key Rules

- Use stylesheet CSS variables
- Header/footer position:fixed
- Solid background colors on chrome
- Self-contained, no external deps
```

---

### Commands

**File: `templates/commands/analyze.md`**

```markdown
# analyze

Analyze wireframes and assets.

## Workers

Spawns 4 parallel workers:
- analyze-styles → outputs/analysis/styles.md
- analyze-flows → outputs/analysis/flows.md
- analyze-assets → outputs/analysis/assets.md
- analyze-components → outputs/analysis/components.md

## Prerequisites

- assets/wireframes/ contains at least 1 image
```

**File: `templates/commands/flows.md`**

```markdown
# flows

Create flow mockups.

## Workers

Spawns N parallel workers (one per flow from analysis).

## Prerequisites

- outputs/analysis/flows.md exists
- outputs/analysis/styles.md exists
```

**File: `templates/commands/mockups.md`**

```markdown
# mockups

Create style mockups.

## Workers

Spawns 3 parallel workers (one per style).

## Prerequisites

- outputs/analysis/styles.md exists
- outputs/analysis/components.md exists
```

**File: `templates/commands/stylesheet.md`**

```markdown
# stylesheet

Create design system.

## Workers

Single worker (no parallelization).

## Options

--style=N (1, 2, or 3)

## Prerequisites

- outputs/mockups/style-N.html exists
```

**File: `templates/commands/screens.md`**

```markdown
# screens

Create all screen designs.

## Workers

Spawns N parallel workers (one per unique screen from flows).

## Prerequisites

- outputs/flows/*.html exist
- outputs/stylesheet/showcase.html exists
```

---

### Project CLAUDE.md

**File: `templates/CLAUDE.md`**

```markdown
# Project Design System

This project uses AgenticFlow for design generation.

## Commands

```bash
agentflow analyze      # Analyze wireframes
agentflow flows        # Create flow mockups
agentflow mockups      # Create style mockups (3 options)
agentflow stylesheet   # Create design system
agentflow screens      # Create all screens
```

## Directory Structure

- `agents/` - Agent definitions
- `skills/` - Skill documentation
- `assets/` - Input wireframes, fonts, icons
- `outputs/` - Generated designs

## Workflow

1. Add wireframes to `assets/wireframes/`
2. Run `agentflow analyze`
3. Review `outputs/analysis/`
4. Run `agentflow flows`
5. Review `outputs/flows/`
6. Run `agentflow mockups`
7. Pick a style (1, 2, or 3)
8. Run `agentflow stylesheet --style=N`
9. Review `outputs/stylesheet/`
10. Run `agentflow screens`
11. Final designs in `outputs/screens/`
```

---

## Build Order

1. `npm init` + install dependencies
2. Create `src/index.ts` (CLI entry)
3. Create `src/lib/agent.ts` (agent invocation)
4. Create `src/lib/worker.ts` (parallel workers)
5. Create `src/lib/project.ts` (project validation)
6. Create `src/commands/init.ts`
7. Create all template files in `src/templates/`
8. Create `src/commands/analyze.ts`
9. Create `src/commands/flows.ts`
10. Create `src/commands/mockups.ts`
11. Create `src/commands/stylesheet.ts`
12. Create `src/commands/screens.ts`
13. Build and test

---

## Summary

```
┌────────────────────────────────────────────────────────────┐
│                    AgenticFlow v2                          │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  CLI:        TypeScript (commander)                        │
│  Agents:     2 (Analyst, UI Designer)                      │
│  Commands:   5 (analyze, flows, mockups, stylesheet, screens) │
│  Execution:  Parallel workers via Claude CLI               │
│                                                            │
│  No: Sessions, Lessons, SQLite, MCP, Architect, PM         │
│                                                            │
└────────────────────────────────────────────────────────────┘
```
